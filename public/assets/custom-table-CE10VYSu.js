class x{constructor(t,s){this.table=t,this.parentInstance=s,this.thead=t.querySelector("thead"),this.tbody=t.querySelector("tbody"),this.headers=[],this.thead&&(this.headers=Array.from(this.thead.querySelectorAll("th"))),this.rows=Array.from(this.tbody.querySelectorAll("tr")),this.filteredRows=[...this.rows],this.rowsPerPage=parseInt(t.getAttribute(this.parentInstance.rowsPerPageAttribute)??this.parentInstance.rowsPerPage),this.currentPage=this.parentInstance.currentPage,this.checkAllCheckBox=null,this.searchInput=null,this.pagination=null,this.paginationInfo=null,this.filters=[],this.rangeFilters=[],this.itemNotFoundMessage="Nothing found.",this.deleteRowMessage="Are you sure you want to delete this row?",this.deleteMultipleRowsMessage="Are you sure you want to delete these rows?"}get totalPages(){return Math.ceil(this.filteredRows.length/this.rowsPerPage)||1}init(){this.setupCheckAll(),this.setupCheckboxListeners(),this.setupSearch(),this.headers.length>0&&(this.setupFilters(),this.setupSort()),this.setupRowsPerPage(),this.setupPagination(),this.setupPaginationInfo(),this.deleteSelected(),this.deleteRow(),this.update()}setupCheckAll(){this.thead&&(this.checkAllCheckBox=this.thead.querySelector(this.parentInstance.checkAllSelector),this.checkAllCheckBox&&this.checkAllCheckBox.addEventListener("click",t=>{const s=this.rows.map(e=>e.querySelector('input[type="checkbox"]'));s&&s.length>0&&s.forEach(e=>e.checked=t.target.checked)}))}setupCheckboxListeners(){const t=this.table.querySelectorAll('input[type="checkbox"]');this.checkAllCheckBox&&t.length>0&&t.forEach(s=>{s.addEventListener("change",()=>{const e=Array.from(t).some(r=>r.checked);this.deleteSelectedSelector&&this.filteredRows.length>0&&this.deleteSelectedSelector.classList.toggle("hidden",!e)})})}setupSearch(){this.searchInput=this.table.querySelector(this.parentInstance.searchSelector),this.searchInput&&this.searchInput.addEventListener("keyup",t=>{const s=t.target.value.toLowerCase();this.filteredRows=this.rows.filter(e=>Array.from(e.querySelectorAll("td")).some(n=>n.textContent.toLowerCase().includes(s))),this.currentPage=1,this.update()})}setupFilters(){this.filters=Array.from(this.table.querySelectorAll(this.parentInstance.filterSelector)),this.filters.forEach(t=>{t.addEventListener("change",()=>{this.applyFilters(),this.currentPage=1,this.update()})}),this.rangeFilters=Array.from(this.table.querySelectorAll(this.parentInstance.rangeFilterSelector)),this.rangeFilters.forEach(t=>{t.addEventListener("change",()=>{this.applyFilters(),this.currentPage=1,this.update()})})}applyFilters(){const t=e=>this.filters.every(r=>{const n=r.value;if(!n||n==="All")return!0;const o=r.dataset.tableFilter,h=this.headers.findIndex(g=>g.dataset.column===o);if(h===-1)return!0;const c=e.children[h];return c?c.textContent.trim().toLowerCase()===n.toLowerCase():!0}),s=e=>this.rangeFilters.every(r=>{const n=r.value;if(!n||n==="All")return!0;const o=r.dataset.tableRangeFilter,h=this.headers.findIndex(l=>l.dataset.column===o);if(h===-1)return!0;const c=e.children[h];if(!c)return!0;const g=c.textContent.trim();if(o.toLowerCase().includes("date")){const l=new Date(g);if(isNaN(l.getTime()))return!1;const a=new Date,d=new Date(a.getFullYear(),a.getMonth(),a.getDate()),i=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1);let p,f;switch(n){case"Today":return l>=d&&l<i;case"Last 7 Days":return p=new Date(a),p.setDate(a.getDate()-7),f=i,l>=p&&l<f;case"Last 30 Days":return p=new Date(a),p.setDate(a.getDate()-30),f=i,l>=p&&l<f;case"This Year":return p=new Date(a.getFullYear(),0,1),f=new Date(a.getFullYear()+1,0,1),l>=p&&l<f;default:return!0}}else{const l=parseFloat(g.replace(/[^\d.-]/g,""));if(isNaN(l))return!1;if(n.endsWith("+")){const i=parseFloat(n.slice(0,-1));return l>=i}const[a,d]=n.split("-").map(i=>parseFloat(i.trim()));return isNaN(a)||isNaN(d)?!1:l>=a&&l<=d}});this.filteredRows=this.rows.filter(e=>t(e)&&s(e))}setupRowsPerPage(){const t=this.table.querySelector(this.parentInstance.rowsPerPageSelector);if(t){const s=Array.from(t.options).map(e=>parseInt(e.value));s.includes(this.rowsPerPage)||s.push(this.rowsPerPage),s.sort((e,r)=>e-r),t.innerHTML="",s.forEach(e=>{const r=document.createElement("option");r.value=e.toString(),r.textContent=e.toString(),t.appendChild(r)}),t.value=this.rowsPerPage,t.addEventListener("change",e=>{e.preventDefault(),this.rowsPerPage=parseInt(e.target.value),this.update()})}}setupPagination(){this.pagination=this.table.querySelector(this.parentInstance.paginationSelector)}renderTablePage(t){this.tbody.innerHTML="";const s=(t-1)*this.rowsPerPage,e=s+this.rowsPerPage,r=this.filteredRows.slice(s,e),n=this.tbody.querySelector(".no-results");if(n&&n.remove(),r.length===0){const o=this.table.querySelectorAll("thead th").length,h=document.createElement("tr");h.className="no-results",h.innerHTML=`<td colspan="${o}" class="text-center text-default-400 py-3">${this.itemNotFoundMessage}</td>`,this.tbody.appendChild(h)}else r.forEach(o=>{this.tbody.appendChild(o)})}renderPagination(){const t=document.createElement("ul");t.className="pagination justify-center",this.pagination.innerHTML="";const s=this.totalPages,e=document.createElement("li");e.className=`page-item ${this.currentPage===1?"disabled":""}`,e.innerHTML='<a href="#" class="page-link"><svg  xmlns="http://www.w3.org/2000/svg"  width="16"  height="16"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 6l-6 6l6 6" /></svg></a>',e.addEventListener("click",n=>{n.preventDefault(),this.currentPage>1&&(this.currentPage--,this.update())}),t.appendChild(e);for(let n=1;n<=s;n++){const o=document.createElement("li");o.className=`page-item ${this.currentPage===n?"active":""}`,o.innerHTML=`<a href="#" class="page-link">${n}</a>`,o.addEventListener("click",h=>{h.preventDefault(),this.currentPage=n,this.update()}),t.appendChild(o)}const r=document.createElement("li");r.className=`page-item ${this.currentPage===s?"disabled":""}`,r.innerHTML='<a href="#" class="page-link"><svg  xmlns="http://www.w3.org/2000/svg"  width="16"  height="16"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 6l6 6l-6 6" /></svg></a>',r.addEventListener("click",n=>{n.preventDefault(),this.currentPage<this.totalPages&&(this.currentPage++,this.update())}),t.appendChild(r),this.pagination.appendChild(t),this.setupPaginationInfo()}setupPaginationInfo(){if(this.paginationInfo=this.table.querySelector(this.parentInstance.paginationInfoSelector),this.paginationInfo){this.paginationInfo.className="text-default-400";const t=this.paginationInfo.getAttribute(this.parentInstance.paginationInfoAttribute),s=(this.currentPage-1)*this.rowsPerPage+1,e=Math.min(this.currentPage*this.rowsPerPage,this.filteredRows.length);this.paginationInfo.innerHTML=`Showing <span class="font-semibold">${s}</span> to <span class="font-semibold">${e}</span> of <span class="font-semibold">${this.filteredRows.length}</span> ${t&&t!==""?t:"entries"}`}}update(){if(this.renderTablePage(this.currentPage),this.pagination){const t=this.filteredRows.length>0;this.pagination.style.display=t?"block":"none",this.paginationInfo&&(this.paginationInfo.style.display=t?"block":"none"),t&&this.renderPagination()}}setupSort(){this.table.querySelectorAll(this.parentInstance.sortSelector).forEach(s=>{s.style.cursor="pointer";let e=s.querySelector("i");e||(e=document.createElement("span"),e.classList.add("inline-flex","align-middle","h-3.75"),e.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" width="13" height="13" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="ms-1.5">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <path d="M3 9l4 -4l4 4m-4 -4v14" />
          <path d="M21 15l-4 4l-4 -4m4 4v-14" />
        </svg>`,s.appendChild(e)),s.addEventListener("click",r=>{r.preventDefault();const n=Array.from(s.parentElement.children).indexOf(s);if(n===-1)return;const o=s.getAttribute(this.parentInstance.sortAttribute),c=s.dataset.direction==="asc"?"desc":"asc";s.dataset.direction=c,c==="asc"?e.innerHTML='<svg  xmlns="http://www.w3.org/2000/svg"  width="13"  height="13"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="ms-1.5"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 5l0 14" /><path d="M16 9l-4 -4" /><path d="M8 9l4 -4" /></svg>':e.innerHTML='<svg  xmlns="http://www.w3.org/2000/svg"  width="13"  height="13"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="ms-1.5"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 5l0 14" /><path d="M16 15l-4 4" /><path d="M8 15l4 4" /></svg>';function g(m,l,a){const d=m.children[l];if(!d)return"";let i="";if(a){const u=d.querySelector(`[data-sort="${a}"]`);i=u?u.textContent.trim():""}else{const u=Array.from(d.childNodes).find(w=>w.nodeType===Node.TEXT_NODE&&w.textContent.trim());i=u?u.textContent.trim():d.textContent.trim()}i=i.replace(/\s+/g," ");const p=i.match(/^\(([\d,.\s]+)\)$/);if(p){const u=parseFloat(p[1].replace(/,/g,""));return isNaN(u)?i.toLowerCase():-u}if(/^-?[\d,.]+%$/.test(i)){const u=parseFloat(i.replace("%",""));return isNaN(u)?0:u/100}const k=/^-?[\$€₹]?\s*([\d,.]+)\s*([KMB])?$/i,b=i.match(k);if(b){let u=parseFloat(b[1].replace(/,/g,""));const w=b[2]?.toUpperCase(),P={K:1e3,M:1e6,B:1e9};if(!isNaN(u))return w&&P[w]&&(u*=P[w]),u}const v=i.match(/^(\d+)(st|nd|rd|th)$/i);if(v)return parseInt(v[1],10);if(/^-?\d+(\.\d+)?$/.test(i)){const u=parseFloat(i);return isNaN(u)?i.toLowerCase():u}const y=new Date(i);return isNaN(y.getTime())?i.toLowerCase():y.getTime()}this.filteredRows.sort((m,l)=>{const a=g(m,n,o),d=g(l,n,o);return typeof a=="number"&&typeof d=="number"?c==="asc"?a-d:d-a:typeof a=="string"&&typeof d=="string"?c==="asc"?a.localeCompare(d):d.localeCompare(a):0}),this.currentPage=1,this.update()})})}deleteSelected(){this.deleteSelectedSelector=this.table.querySelector(this.parentInstance.deleteSelectedSelector),this.deleteSelectedSelector&&this.deleteSelectedSelector.addEventListener("click",t=>{t.preventDefault();const s=this.rows.filter(e=>e.querySelector('input[type="checkbox"]').checked);if(s.length>0){const{confirmButton:e,modalElement:r}=this.deleteAlert(s.length>1?this.deleteMultipleRowsMessage:this.deleteRowMessage),n=this.rows,o=()=>{s.forEach(c=>c.remove());const h=n.filter(c=>!s.includes(c));this.rows=[...h],this.filteredRows=[...h],this.currentPage>this.totalPages&&(this.currentPage=this.totalPages),this.update(),HSOverlay.close(r),this.deleteSelectedSelector.classList.add("hidden"),this.checkAllCheckBox.checked=!1};e.addEventListener("click",o)}})}deleteRow(){const t=this.table.querySelectorAll(this.parentInstance.deleteRowSelector);t&&t.forEach(s=>{s.addEventListener("click",e=>{e.preventDefault();const r=this.rows,{confirmButton:n,modalElement:o}=this.deleteAlert(),h=()=>{const c=s.closest("tr");if(!c)return;c.remove();const g=r.filter(m=>m!==c);this.rows=[...g],this.filteredRows=[...g],this.currentPage>this.totalPages&&(this.currentPage=this.totalPages),this.update(),HSOverlay.close(o)};n.addEventListener("click",h,{once:!0})})})}deleteAlert(t){const s=`
            <div id="confirm-delete-modal" class="hs-overlay pointer-events-none fixed start-0 top-0 z-80 hidden size-full overflow-x-hidden overflow-y-auto" tabindex="-1" aria-hidden="true">
                <div class="hs-overlay-animation-target hs-overlay-open:scale-100 hs-overlay-open:opacity-100 m-3 flex min-h-[calc(100%-56px)] scale-95 items-center opacity-0 transition-all duration-200 ease-in-out sm:mx-auto sm:w-full sm:max-w-lg">
                    <div class="border-default-300 pointer-events-auto flex w-full flex-col rounded-md border bg-card">
               <div class="border-default-300 flex items-center justify-between border-b p-6">
                            <h4 id="confirm-delete-modalLabel" class="text-base font-bold">Confirm Deletion</h4>
                            <button type="button" aria-label="Close" data-hs-overlay="#confirm-delete-modal">
                                <i class="close-icon size-5"></i>
                            </button>
                        </div>
                        <div class="overflow-y-auto p-5">   
                            <p>${t??this.deleteRowMessage}</p>
                        </div>
                        <div class="border-default-300 flex items-center justify-end gap-x-2 border-t p-5">
                            <button type="button" class="btn bg-light hover:text-primary" data-hs-overlay="#confirm-delete-modal">Cancel</button>
                            <button type="button" class="btn bg-danger text-white hover:bg-danger-hover" id="confirm-delete">Delete</button>
                        </div>
                    </div>
                </div>
            </div>`,e=document.getElementById("confirm-delete-modal");e&&e.remove(),document.body.insertAdjacentHTML("beforeend",s);const r=document.getElementById("confirm-delete-modal"),n=HSOverlay.getInstance(r)||new HSOverlay(r);HSOverlay.open(r);const o=r.querySelector("#confirm-delete");return{modal:n,confirmButton:o,modalElement:r}}}class C{constructor({tableSelector:t="[data-table]",checkAllSelector:s="[data-table-select-all]",searchSelector:e="[data-table-search]",filterSelector:r="select[data-table-filter], input[data-table-filter]",rangeFilterSelector:n="select[data-table-range-filter], input[data-table-range-filter]",rowsPerPageSelector:o="[data-table-set-rows-per-page]",rowsPerPageAttribute:h="data-table-rows-per-page",paginationSelector:c="[data-table-pagination]",sortSelector:g="[data-table-sort]",sortAttribute:m="data-table-sort",paginationInfoSelector:l="[data-table-pagination-info]",paginationInfoAttribute:a="data-table-pagination-info",deleteSelectedSelector:d="[data-table-delete-selected]",deleteRowSelector:i="[data-table-delete-row]",rowsPerPage:p=10,currentPage:f=1}={}){this.tableSelector=t,this.checkAllSelector=s,this.searchSelector=e,this.filterSelector=r,this.rangeFilterSelector=n,this.rowsPerPageSelector=o,this.rowsPerPageAttribute=h,this.paginationSelector=c,this.sortSelector=g,this.sortAttribute=m,this.paginationInfoSelector=l,this.paginationInfoAttribute=a,this.deleteSelectedSelector=d,this.deleteRowSelector=i,this.rowsPerPage=p,this.currentPage=f,this.tables=[],this.init()}init(){document.querySelectorAll(this.tableSelector).forEach(s=>{const e=new x(s,this);this.tables.push(e),e.init()})}}document.addEventListener("DOMContentLoaded",()=>{new C});
